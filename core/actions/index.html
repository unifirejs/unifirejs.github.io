<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Actions</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.febf9ffe.css" as="style"><link rel="preload" href="/assets/js/app.918ec15a.js" as="script"><link rel="preload" href="/assets/js/2.495b4bba.js" as="script"><link rel="preload" href="/assets/js/9.4803d6ff.js" as="script"><link rel="prefetch" href="/assets/js/10.0433ba08.js"><link rel="prefetch" href="/assets/js/11.12e41f4a.js"><link rel="prefetch" href="/assets/js/12.27b49d29.js"><link rel="prefetch" href="/assets/js/13.c49d3af3.js"><link rel="prefetch" href="/assets/js/14.3e2c6852.js"><link rel="prefetch" href="/assets/js/15.a7307367.js"><link rel="prefetch" href="/assets/js/16.982cfb2d.js"><link rel="prefetch" href="/assets/js/17.eaf20302.js"><link rel="prefetch" href="/assets/js/18.122922de.js"><link rel="prefetch" href="/assets/js/19.39e2e902.js"><link rel="prefetch" href="/assets/js/20.dab1c528.js"><link rel="prefetch" href="/assets/js/21.6280c146.js"><link rel="prefetch" href="/assets/js/22.79c510d7.js"><link rel="prefetch" href="/assets/js/3.5e402e44.js"><link rel="prefetch" href="/assets/js/4.81343487.js"><link rel="prefetch" href="/assets/js/5.dcbd2805.js"><link rel="prefetch" href="/assets/js/6.f021f97b.js"><link rel="prefetch" href="/assets/js/7.ce609695.js"><link rel="prefetch" href="/assets/js/8.a513c13b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.febf9ffe.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/unifire-logo.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://github.com/unifirejs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://github.com/unifirejs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Intro</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/" aria-current="page" class="sidebar-link">What's Unifire?</a></li><li><a href="/intro/quick/" class="sidebar-link">Quick Start</a></li><li><a href="/intro/installation/" class="sidebar-link">Installation</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Core Concepts</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/core/state/" class="sidebar-link">State</a></li><li><a href="/core/derived/" class="sidebar-link">Derived State</a></li><li><a href="/core/actions/" aria-current="page" class="active sidebar-link">Actions</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/core/subscribers/" class="sidebar-link">Subscribers</a></li><li><a href="/core/listeners/" class="sidebar-link">Listeners</a></li><li><a href="/core/lazy/" class="sidebar-link">Code Splitting</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Additional Concepts</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/additional/composition/" class="sidebar-link">Composing Stores</a></li><li><a href="/additional/testing/" class="sidebar-link">Writing Tests</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Integrations</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/integrations/preact/" class="sidebar-link">Preact</a></li><li><a href="/integrations/react/" class="sidebar-link">React</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Extensions</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/extensions/indexedDB/" class="sidebar-link">indexedDB</a></li><li><a href="/extensions/storage/" class="sidebar-link">Browser Storage</a></li></ul></section></li><li><a href="/api/" class="sidebar-link">API</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="actions"><a href="#actions" class="header-anchor">#</a> Actions</h1> <p>Unifire has no limitations on what you can do in your actions. Write your code however you want to write it. Unifire will call the right subscribers at the right time, batched as efficiently as possible.</p> <h3 id="basics"><a href="#basics" class="header-anchor">#</a> Basics</h3> <p>Let's create a store called <code>counter</code> with actions to <code>increment</code> and <code>decrement</code> count.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span> count<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> actions <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">increment</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> state <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">,</span>
  <span class="token function-variable function">decrement</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> state <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>count<span class="token operator">--</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> counter <span class="token operator">=</span> <span class="token function">Unifire</span><span class="token punctuation">(</span><span class="token punctuation">{</span> state<span class="token punctuation">,</span> actions <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>To call an action, call <code>fire</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code>counter<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If your action returns a value, <code>fire</code> will return that same value.</p> <h3 id="custom-params"><a href="#custom-params" class="header-anchor">#</a> Custom Params</h3> <p>Actions often require additional context to run. You can provide a custom argument as follows.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> actions <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">sum</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> state <span class="token punctuation">}</span><span class="token punctuation">,</span> num</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>count<span class="token operator">+=</span> num
<span class="token punctuation">}</span><span class="token punctuation">;</span>

counter<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'sum'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="async-actions"><a href="#async-actions" class="header-anchor">#</a> Async Actions</h3> <p>Showing a loading state while fetching some data is an extremely common practice. Let's build it!</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span>
  loading<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> actions <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">fetchData</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> state <span class="token punctuation">}</span><span class="token punctuation">,</span> id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    state<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">asyncCall</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    state<span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">Unifire</span><span class="token punctuation">(</span><span class="token punctuation">{</span> state<span class="token punctuation">,</span> actions <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

store<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'fetchData'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>There are two nice things about this example. First, Unifire does not require you to separate your actions into sync and async bits--just write your code how you want to write it. Second, despite the fact that this action makes three state mutations, Unifire will intelligently batch them into two state updates--one to set <code>state.loading</code> to <code>true</code>, and another to assign <code>state.data</code> and set <code>state.loading</code> back to <code>false</code>.</p> <p>Another common workflow might be to pop up a toast that dismisses itself after a few seconds. You can do that with a single action too.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> actions <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">showToast</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> state <span class="token punctuation">}</span><span class="token punctuation">,</span> message</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>toast <span class="token operator">=</span> message<span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>toast <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

store<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'showToast'</span><span class="token punctuation">,</span> <span class="token string">'Some Notification'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="composing-actions"><a href="#composing-actions" class="header-anchor">#</a> Composing Actions</h3> <p>Sometimes it can be useful to chain actions together. Unifire makes this easy. Use the <code>fire</code> param made available to all actions.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> actions <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">actionA</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> state <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>someVal <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">asyncCall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">actionB</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> state<span class="token punctuation">,</span> fire <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'actionA'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    state<span class="token punctuation">.</span>someOtherVal <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

store<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'actionB'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/core/derived/" class="prev">
        Derived State
      </a></span> <span class="next"><a href="/core/subscribers/">
        Subscribers
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.918ec15a.js" defer></script><script src="/assets/js/2.495b4bba.js" defer></script><script src="/assets/js/9.4803d6ff.js" defer></script>
  </body>
</html>
